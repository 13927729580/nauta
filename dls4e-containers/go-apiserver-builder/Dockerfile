ARG BASE_IMAGE=build-go:1.10.2
FROM ${BASE_IMAGE}

ENV APISERVER_BUILDER_VERSION=v1.9-alpha.4
ENV APISERVER_BUILDER_ARCH=amd64
ENV APISERVER_BUILDER_OS=linux
ENV APISERVER_BUILDER_CHECKSUM=6f82bb4d063b46a920f2952debd9ade19e712e7472d43e97ff09a2bf2f705ca6

ENV APISERVER_BUILDER_FILE=apiserver-builder-${APISERVER_BUILDER_VERSION}-${APISERVER_BUILDER_OS}-${APISERVER_BUILDER_ARCH}.tar.gz
ENV APISERVER_BUILDER_URL=https://github.com/kubernetes-incubator/apiserver-builder/releases/download/${APISERVER_BUILDER_VERSION}/${APISERVER_BUILDER_FILE}


RUN mkdir -p /apiserver-builder

RUN curl -Lf ${APISERVER_BUILDER_URL} -o /tmp/${APISERVER_BUILDER_FILE} && \
    echo "${APISERVER_BUILDER_CHECKSUM} */tmp/${APISERVER_BUILDER_FILE}" | sha256sum -c - && \
    tar -zvxf /tmp/${APISERVER_BUILDER_FILE} -C /apiserver-builder && \
    rm -rf /tmp/${APISERVER_BUILDER_FILE}

ENV APISERVER_BUILDER_PATH=/apiserver-builder/bin
ENV PATH=${PATH}:${APISERVER_BUILDER_PATH}
